<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>High-level API · DynamicHMC.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMC.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Overview</a></li><li class="current"><a class="toctext" href>High-level API</a><ul class="internal"><li class="toplevel"><a class="toctext" href="#Sampling-and-accessors-1">Sampling and accessors</a></li><li class="toplevel"><a class="toctext" href="#Diagnostics-1">Diagnostics</a></li><li class="toplevel"><a class="toctext" href="#Fine-grained-control-1">Fine-grained control</a></li><li><a class="toctext" href="#Kinetic-energy-1">Kinetic energy</a></li><li><a class="toctext" href="#tuning-1">NUTS parameters and tuning</a></li></ul></li><li><a class="toctext" href="../lowlevel/">Low-level building blocks</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>High-level API</a></li></ul><a class="edit-page" href="https://github.com/tpapp/DynamicHMC.jl/blob/master/docs/src/api.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>High-level API</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="ell-tutorial-1" href="#ell-tutorial-1">The density function <span>$\ell$</span>: an example</a></h1><p>The density function should take a single argument <code>q</code>, which is a vector of numbers, and return an object which provides the methods <code>DiffResults.value</code> and <code>DiffResults.gradient</code> to access <span>$\ell(q)$</span> and <span>$\nabla\ell(q)$</span>, respectively.</p><p>The following example implements the density function for <span>$n$</span> observations from a <span>$\text{Bernoulli}(\alpha)$</span> distribution, <span>$s$</span> of which are <code>1</code>. The complete example is available in <a href="https://github.com/tpapp/DynamicHMC.jl/blob/master/test/test-sample-dummy.jl"><code>tests/example.jl</code></a>.</p><p>It is convenient to define a structure that holds the data,</p><pre><code class="language-julia">struct BernoulliProblem
    &quot;Total number of draws in the data.&quot;
    n::Int
    &quot;Number of draws =1 in the data.&quot;
    s::Int
end</code></pre><p>then make it callable:</p><pre><code class="language-julia">function (problem::BernoulliProblem)(α)
    @unpack n, s = problem        # using Parameters
    s * log(α) + (n-s) * log(1-α) # log likelihood
end</code></pre><p>and finally define an object with actual data:</p><pre><code class="language-julia">p = BernoulliProblem(100, 40)                             # original problem</code></pre><p>The value <code>p</code> is a function that takes a single real number, and returns the likelihood. However, the functions in this package</p><ol><li><p>take a <strong>vector</strong> which contains elements in <span>$\mathbb{R}$</span>, and</p></li><li><p>expect <span>$\ell$</span> (ie <code>p</code> above) to return an object that can provide the <strong>value and the derivatives</strong>.</p></li></ol><p>We could implement both manually, but it is convenient to use wrappers from two packages mentioned in the <a href="../#Introduction-1">introduction</a>:</p><pre><code class="language-julia">pt = TransformLogLikelihood(p, bridge(ℝ, Segment(0, 1)))  # transform
pt∇ = ForwardGradientWrapper(pt, [0.0]);                  # AD using ForwardDiff.jl</code></pre><p>Then we can call the high-level function <a href="#DynamicHMC.NUTS_init_tune_mcmc"><code>NUTS_init_tune_mcmc</code></a> that initializes and tunes the sampler, and samples from it:</p><pre><code class="language-julia">sample, NUTS_tuned = NUTS_init_tune_mcmc(pt∇, 1, 1000);</code></pre><p>The returned objects are the <em>sample</em>, which contains the draws and diagnostic information, and the tuned sampler, which we could use to continue sampling.</p><p>We obtain the posterior using the transformation and <a href="#DynamicHMC.get_position"><code>get_position</code></a>:</p><pre><code class="language-julia">posterior = map(get_transformation(pt) ∘ get_position, sample);</code></pre><p>which is a vector of vectors. Calculate the effective sample size and NUTS-specific statistics as</p><pre><code class="language-julia">julia&gt; effective_sample_size(first.(posterior))
323.6134099739428

julia&gt; NUTS_statistics(sample)         # NUTS-specific statistics
Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.92, min/25%/median/75%/max: 0.26 0.87 0.97 1.0 1.0
  termination: AdjacentTurn =&gt; 31% DoubledTurn =&gt; 69%
  depth: 1 =&gt; 66% 2 =&gt; 34%</code></pre><h1><a class="nav-anchor" id="Sampling-and-accessors-1" href="#Sampling-and-accessors-1">Sampling and accessors</a></h1><p>Most users would use this function, which initializes and tunes the parameters of the algorithm, then samples. Parameters can be set manually for difficult posteriors.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.NUTS_init_tune_mcmc" href="#DynamicHMC.NUTS_init_tune_mcmc"><code>DynamicHMC.NUTS_init_tune_mcmc</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-julia">NUTS_init_tune_mcmc(rng, ℓ, q_or_dim, N; args...)
</code></pre><p>Init, tune, and then draw <code>N</code> samples from <code>ℓ</code> using the NUTS algorithm.</p><p>Return the <em>sample</em> (a vector of <a href="../lowlevel/#DynamicHMC.NUTS_transition"><code>NUTS_transition</code></a>s) and the <em>tuned sampler</em>.</p><p><code>rng</code> is the random number generator.</p><p><code>q_or_dim</code> is a starting position or the dimension (for random initialization).</p><p><code>args</code> are passed on to various methods, see <a href="#DynamicHMC.NUTS_init"><code>NUTS_init</code></a> and <a href="#DynamicHMC.bracketed_doubling_tuner"><code>bracketed_doubling_tuner</code></a>.</p><p>For parameters <code>q</code>, <code>ℓ(q)</code> should return an object that support the following methods: <code>DiffResults.value</code>, <code>DiffResults.gradient</code>.</p><p>Most users would use this function, unless they are doing something that requires manual tuning.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L1100-L1120">source</a><div><pre><code class="language-julia">NUTS_init_tune_mcmc(ℓ, q_or_dim, N; args...)
</code></pre><p>Same as the other method, but with random number generator <code>Base.Random.GLOBAL_RNG</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L1127-L1132">source</a></section><div class="admonition important"><div class="admonition-title">Important</div><div class="admonition-text"><p>The <a href="#DynamicHMC.NUTS"><code>NUTS</code></a> sampler saves a random number generator and uses it for random draws. When running in parallel, you should initialize <a href="#DynamicHMC.NUTS_init_tune_mcmc"><code>NUTS_init_tune_mcmc</code></a> with a random number generator as its first argument explicitly, making sure that each thread has its own one.</p></div></div><p>These functions can be used use to perform the steps above manually.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.NUTS_init" href="#DynamicHMC.NUTS_init"><code>DynamicHMC.NUTS_init</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">NUTS_init(rng, ℓ, q; κ = GaussianKE(length(q)), p, max_depth, ϵ)</code></pre><p>Initialize a NUTS sampler for log density <code>ℓ</code> using local information.</p><p><strong>Arguments</strong></p><ul><li><p><code>rng</code>: the random number generator</p></li><li><p><code>ℓ</code>: the likelihood function, should return a type that supports <code>DiffResults.value</code> and <code>DiffResults.gradient</code></p></li><li><p><code>q</code>: initial position.</p></li><li><p><code>κ</code>: kinetic energy specification. <em>Default</em>: Gaussian with identity matrix.</p></li><li><p><code>p</code>: initial momentum. <em>Default</em>: random from standard multivariate normal.</p></li><li><p><code>max_depth</code>: maximum tree depth. <em>Default</em>: <code>5</code>.</p></li><li><p><code>ϵ</code>: initial stepsize, or parameters for finding it (passed on to <a href="../lowlevel/#DynamicHMC.find_initial_stepsize"><code>find_initial_stepsize</code></a>.</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L940-L962">source</a><div><pre><code class="language-none">NUTS_init(rng, ℓ, dim::Integer; args...)</code></pre><p>Random initialization with position <code>randn(dim)</code>, all other arguments are passed on the the other method of this function.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L976-L981">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.tune" href="#DynamicHMC.tune"><code>DynamicHMC.tune</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">sampler′ = tune(sampler, tune)</code></pre><p>Given a <code>sampler</code> (or similar a parametrization) and a <code>tuner</code>, return the updated sampler state after tuning.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L997-L1002">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.mcmc" href="#DynamicHMC.mcmc"><code>DynamicHMC.mcmc</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">mcmc(sampler, N)</code></pre><p>Run the MCMC <code>sampler</code> for <code>N</code> iterations, returning the results as a vector, which has elements that conform to the sampler.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L871-L876">source</a></section><p>The resulting sample is a vector of <a href="#DynamicHMC.NUTS_Transition"><code>NUTS_Transition</code></a> objects, for which the following accessors exist:</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.NUTS_Transition" href="#DynamicHMC.NUTS_Transition"><code>DynamicHMC.NUTS_Transition</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Single transition by the No-U-turn sampler. Contains new position and diagnostic information.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L790-L793">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.get_position" href="#DynamicHMC.get_position"><code>DynamicHMC.get_position</code></a> — <span class="docstring-category">Function</span>.</div><div><p>Position after transition.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L809">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.get_neg_energy" href="#DynamicHMC.get_neg_energy"><code>DynamicHMC.get_neg_energy</code></a> — <span class="docstring-category">Function</span>.</div><div><p>Negative energy of the Hamiltonian at the position.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L812">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.get_depth" href="#DynamicHMC.get_depth"><code>DynamicHMC.get_depth</code></a> — <span class="docstring-category">Function</span>.</div><div><p>Tree depth.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L815">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.get_termination" href="#DynamicHMC.get_termination"><code>DynamicHMC.get_termination</code></a> — <span class="docstring-category">Function</span>.</div><div><p>Reason for termination, see <a href="../lowlevel/#DynamicHMC.Termination"><code>Termination</code></a>.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L818">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.get_acceptance_rate" href="#DynamicHMC.get_acceptance_rate"><code>DynamicHMC.get_acceptance_rate</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">get_acceptance_rate(x)</code></pre><p>Return average Metropolis acceptance rate.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L686-L690">source</a><div><p>Average acceptance rate over trajectory.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L821">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.get_steps" href="#DynamicHMC.get_steps"><code>DynamicHMC.get_steps</code></a> — <span class="docstring-category">Function</span>.</div><div><p>Number of integrator steps.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L824">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.get_position_matrix" href="#DynamicHMC.get_position_matrix"><code>DynamicHMC.get_position_matrix</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">variable_matrix(posterior)</code></pre><p>Return the samples of the parameter vector as rows of a matrix.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L912-L916">source</a></section><h1><a class="nav-anchor" id="Diagnostics-1" href="#Diagnostics-1">Diagnostics</a></h1><p>These are NUTS-specific diagnostics and statistics (except for <a href="#DynamicHMC.sample_cov"><code>sample_cov</code></a>, which is a convenience function). It is also prudent to use generic MCMC convergence diagnostics, as suggested in the <a href="../#Introduction-1">introduction</a>.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.NUTS_statistics" href="#DynamicHMC.NUTS_statistics"><code>DynamicHMC.NUTS_statistics</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">NUTS_statistics(sample)</code></pre><p>Return statistics about the sample (ie not the variables). Mostly useful for NUTS diagnostics.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L1161-L1166">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.sample_cov" href="#DynamicHMC.sample_cov"><code>DynamicHMC.sample_cov</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">sample_cov(sample)</code></pre><p>Covariance matrix of the sample.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L923-L927">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.EBFMI" href="#DynamicHMC.EBFMI"><code>DynamicHMC.EBFMI</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">EBFMI(sample)</code></pre><p>Energy Bayesian fraction of missing information. Useful for diagnosing poorly chosen kinetic energies.</p><p>Low values (<code>≤ 0.3</code>) are considered problematic. See Betancourt (2016).</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L930-L937">source</a></section><h1><a class="nav-anchor" id="Fine-grained-control-1" href="#Fine-grained-control-1">Fine-grained control</a></h1><h2><a class="nav-anchor" id="Kinetic-energy-1" href="#Kinetic-energy-1">Kinetic energy</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.KineticEnergy" href="#DynamicHMC.KineticEnergy"><code>DynamicHMC.KineticEnergy</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Kinetic energy specifications.</p><p>For all subtypes, it is assumed that kinetic energy is symmetric in the momentum <code>p</code>, ie.</p><pre><code class="language-julia">neg_energy(::KineticEnergy, p, q) == neg_energy(::KineticEnergy, -p, q)</code></pre><p>When the above is violated, various implicit assumptions will not hold.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L27-L38">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.EuclideanKE" href="#DynamicHMC.EuclideanKE"><code>DynamicHMC.EuclideanKE</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Euclidean kinetic energies (position independent).</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L41">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.GaussianKE" href="#DynamicHMC.GaussianKE"><code>DynamicHMC.GaussianKE</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Gaussian kinetic energy.</p><div>\[p \mid q ∼ \text{Normal}(0, M) \qquad (\text{importantly, independent of $q$})\]</div><p>The inverse covariance <code>M⁻¹</code> is stored.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L44-L52">source</a></section><h2><a class="nav-anchor" id="tuning-1" href="#tuning-1">NUTS parameters and tuning</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.NUTS" href="#DynamicHMC.NUTS"><code>DynamicHMC.NUTS</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Specification for the No-U-turn algorithm, including the random number generator, Hamiltonian, the initial position, and various parameters.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L846-L849">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.AbstractTuner" href="#DynamicHMC.AbstractTuner"><code>DynamicHMC.AbstractTuner</code></a> — <span class="docstring-category">Type</span>.</div><div><p>A tuner that adapts the sampler.</p><p>All subtypes support <code>length</code> which returns the number of steps (<em>note</em>: if not in field <code>N</code>, define <code>length</code> accordingly), other parameters vary.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L987-L992">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.StepsizeTuner" href="#DynamicHMC.StepsizeTuner"><code>DynamicHMC.StepsizeTuner</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Adapt the integrator stepsize for <code>N</code> samples.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L1008">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.StepsizeCovTuner" href="#DynamicHMC.StepsizeCovTuner"><code>DynamicHMC.StepsizeCovTuner</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Tune the integrator stepsize and covariance. Covariance tuning is from scratch (no prior information is used), regularized towards the identity matrix.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L1022-L1025">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.TunerSequence" href="#DynamicHMC.TunerSequence"><code>DynamicHMC.TunerSequence</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Sequence of tuners, applied in the given order.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L1052">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.mcmc_adapting_ϵ" href="#DynamicHMC.mcmc_adapting_ϵ"><code>DynamicHMC.mcmc_adapting_ϵ</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">sample, A = mcmc_adapting_ϵ(rng, sampler, N, [A_params, A])</code></pre><p>Same as <a href="#DynamicHMC.mcmc"><code>mcmc</code></a>, but <a href="#DynamicHMC.tune"><code>tune</code></a> stepsize ϵ according to the parameters <code>A_params</code> and initial state <code>A</code>. Return the updated <code>A</code> as the second value.</p><p>When the last two parameters are not specified, initialize using <code>adapting_ϵ</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L888-L896">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DynamicHMC.bracketed_doubling_tuner" href="#DynamicHMC.bracketed_doubling_tuner"><code>DynamicHMC.bracketed_doubling_tuner</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">bracketed_doubling_tuner(; [init], [mid], [M], [term], [regularize])</code></pre><p>A sequence of tuners:</p><ol><li><p>tuning stepsize with <code>init</code> steps</p></li><li><p>tuning stepsize and covariance: first with <code>mid</code> steps, then repeat with twice the steps <code>M</code> times</p></li><li><p>tuning stepsize with <code>term</code> steps</p></li></ol><p><code>regularize</code> is used for covariance regularization.</p></div><a class="source-link" target="_blank" href="https://github.com/tpapp/DynamicHMC.jl/blob/4b7cc864fd3f7faf7372f0bd9132519cf1b5ae7b/src/DynamicHMC.jl#L1068-L1081">source</a></section><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">Overview</span></a><a class="next" href="../lowlevel/"><span class="direction">Next</span><span class="title">Low-level building blocks</span></a></footer></article></body></html>
